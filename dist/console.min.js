(self.webpackChunkcourselib=self.webpackChunkcourselib||[]).push([[828],{39307:t=>{t.exports={mounted:function(){this.$root.setTitle("Page does not exist...")}}},95819:(t,n,e)=>{"use strict";e.d(n,{X:()=>ct});var o=function(t,n){for(var e in n)this[e]=n[e];this.available=function(n){var e=this.atLeast;return e===Object(e)&&(e=t.permissions.atLeast(e.tag,e.default)),void 0===e||n.atLeast(e)}},r=function(t,n){this.title=n.title,this.order=n.order,this.options=[],this.add=function(n){this.options.push(new o(t,n))},this.sort=function(){this.options.sort((function(t,n){return t.order-n.order}))},this.available=function(t){return t.atLeast(this.minimumRole(t))},this.minimumRole=function(n){if(0===this.options.length)return"A";var e=null,o=1e6;return this.options.forEach((function(r){var i=r.atLeast;i===Object(i)&&(i=t.permissions.atLeast(i.tag,i.default));var s=n.getRolePriority(i);0!==s&&s<o&&(e=i,o=s)})),null===e?"A":e}},i=function(t,n){var e=this;this.title=n.title,this.route=n.route,this.order=n.order,this.component=n.component,this.atLeast=void 0!==n.atLeast?n.atLeast:null,this.sections=[],this.add=function(n){if(void 0!==n.section){var e=o(n.section.title);if(null!==e)e.add(n);else{var i=new r(t,n.section);this.sections.push(i),i.add(n)}}},this.sort=function(){this.sections.sort((function(t,n){return t.order-n.order})),this.sections.forEach((function(t){t.sort()}))};var o=function(t){for(var n in e.sections)if(e.sections[n].title===t)return e.sections[n];return null};this.available=function(t){return t.atLeast(this.minimumRole(t))},this.minimumRole=function(n){var e=this.atLeast;e===Object(e)&&(e=t.permissions.atLeast(e.tag,e.default));var o=null!==this.atLeast?n.getRolePriority(e):1e5;return this.sections.forEach((function(t){var r=t.minimumRole(n),i=n.getRolePriority(r);0!==i&&i<o&&(e=r,o=i)})),null===e?"A":e}};function s(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return a(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return a(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return s=t.done,t},e:function(t){c=!0,i=t},f:function(){try{s||null==e.return||e.return()}finally{if(c)throw i}}}}function a(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=new Array(n);e<n;e++)o[e]=t[e];return o}var c=function(t){var n=this,e=[];this.addStart=function(t){e.push(t)},this.start=function(t){e.forEach((function(n){n(t)}))},this.main=[],this.addMainComponent=function(t,n,e){},this.nav2=[],this.addNav2=function(t,n){return this.nav2.push({component:t,order:n}),this.nav2.sort((function(t,n){return t.order-n.order})),t},this.removeNav2=function(t,n){if(Array.isArray(n)){var e,o=s(n);try{for(o.s();!(e=o.n()).done;){var r=e.value;this.removeNav2(t,r)}}catch(t){o.e(t)}finally{o.f()}}else for(var i=0;i<this.nav2.length;i++)if(this.nav2[i].component.template===n.template)return void this.nav2.splice(i,1)},this.addNav2Link=function(t,n,e,o){var r={template:'<a @click.prevent="click">'.concat(n,"</a>"),methods:{click:function(){o()}}};return this.addNav2(r,e),this.nav2.sort((function(t,n){return t.order-n.order})),r},this.nav2right=null,this.nav2left=null;var o=[];this.addOption=function(t){o.push(t)},this.pages=[],this.sort=function(){var n=this;o.forEach((function(e){var o=a(e.page.title);if(null!==o)o.add(e);else{var r=new i(t,e.page);n.pages.push(r),r.add(e)}})),this.pages.sort((function(t,n){return t.order-n.order})),this.pages.forEach((function(t){t.sort()})),this.main.sort((function(t,n){return t.order-n.order}))},this.getPages=function(){return this.pages};var r=[];this.addRoute=function(t){r.push(t)},this.addRoutes=function(t){var n,e=s(t);try{for(e.s();!(n=e.n()).done;){var o=n.value;r.push(o)}}catch(t){e.e(t)}finally{e.f()}},this.getRoutes=function(){return r};var a=function(t){for(var e in n.pages)if(n.pages[e].title===t)return n.pages[e];return null}},u=function(){this.tables=[{title:"Site",order:0,api:"/api/site/tables"}],this.add=function(t){this.tables.push(t)}},l=function(t,n,e,o){var r=this;this.template='<div id="cl-console-main"><div class="content">';var i={},s=1;o.sections.forEach((function(t){if(t.available(e)){r.template+="<h2>".concat(t.title,"</h2>");var o="";t.options.forEach((function(t){if(void 0!==t.title){var r=t.atLeast;r===Object(r)&&(r=n.permissions.atLeast(r.tag,r.default)),(void 0===r||e.atLeast(r))&&(o+='<li><router-link to="'.concat(n.root,"/cl/console").concat(t.route,'">').concat(t.title,"</router-link></li>"))}})),o.length>0&&(r.template+="<ul>"+o+"</ul>"),t.options.forEach((function(t){void 0!==t.component&&(r.template+="<console-component-".concat(s,"></console-component-").concat(s,">"),i["console-component-"+s]=t.component,s++)}))}})),this.template+="</div></div>",this.components=i,this.mounted=function(){"Main"===o.title?this.$root.setTitle(""):this.$root.setTitle(": "+o.title)}},f=e(34802),h={class:"cl-nav"},d={class:"dividers"},p=["href"],v=[(0,f._)("span",{class:"home"},"Home",-1)],m={key:0},g={class:"nav2"},b={class:"left"},y={class:"center"},w={class:"right"};function k(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return L(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return L(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return s=t.done,t},e:function(t){a=!0,i=t},f:function(){try{s||null==e.return||e.return()}finally{if(a)throw i}}}}function L(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=new Array(n);e<n;e++)o[e]=t[e];return o}const A={props:["courseconsole","user"],data:function(){return{homeLink:""}},computed:{pages:function(){var t,n=[],e=k(this.courseconsole.components.pages);try{for(e.s();!(t=e.n()).done;){var o=t.value;o.available(this.user)&&n.push(o)}}catch(t){e.e(t)}finally{e.f()}return n},nav2:function(){var t,n=[],e=k(this.courseconsole.components.nav2);try{for(e.s();!(t=e.n()).done;){var o=t.value;n.push((0,f.IU)(o.component))}}catch(t){e.e(t)}finally{e.f()}return n},short:function(){return this.courseconsole.components.nav2.length>2}},mounted:function(){this.homeLink=this.$site.root+"/"},methods:{pageLink:function(t){return"".concat(this.$site.root,"/cl/console").concat(t.route)},toRaw:function(t){return(0,f.IU)(t)}}};var S=e(76906);const _=(0,S.Z)(A,[["render",function(t,n,e,o,r,i){var s=(0,f.up)("router-link");return(0,f.wg)(),(0,f.iD)("nav",h,[(0,f._)("div",null,[(0,f._)("ul",d,[(0,f._)("li",null,[(0,f._)("a",{href:t.homeLink},v,8,p)]),((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(i.pages,(function(t){return(0,f.wg)(),(0,f.iD)("li",null,[(0,f.Wm)(s,{to:i.pageLink(t)},{default:(0,f.w5)((function(){return[(0,f.Uk)((0,f.zw)(t.title),1)]})),_:2},1032,["to"])])})),256))])]),e.courseconsole.components.nav2.length>0?((0,f.wg)(),(0,f.iD)("div",m,[(0,f._)("div",g,[(0,f._)("div",b,[e.courseconsole.components.nav2left?((0,f.wg)(),(0,f.j4)((0,f.LL)(i.toRaw(e.courseconsole.components.nav2left)),{key:0})):(0,f.kq)("v-if",!0)]),(0,f._)("div",y,[((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(e.courseconsole.components.nav2,(function(t){return(0,f.wg)(),(0,f.iD)("div",null,[((0,f.wg)(),(0,f.j4)((0,f.LL)(i.toRaw(t.component)),{short:e.courseconsole.components.nav2.length>2},null,8,["short"]))])})),256))]),(0,f._)("div",w,[e.courseconsole.components.nav2right?((0,f.wg)(),(0,f.j4)((0,f.LL)(i.toRaw(e.courseconsole.components.nav2right)),{key:0})):(0,f.kq)("v-if",!0)])])])):(0,f.kq)("v-if",!0)])}]]);var $={class:"content"},C=[(0,f._)("p",null,"Page does not exist...",-1)];var E=e(39307),T=e.n(E);const O=(0,S.Z)(T(),[["render",function(t,n,e,o,r,i){return(0,f.wg)(),(0,f.iD)("div",$,C)}]]);var R=e(96313);function N(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(!t)return;if("string"==typeof t)return j(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return j(t,n)}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return s=t.done,t},e:function(t){a=!0,i=t},f:function(){try{s||null==e.return||e.return()}finally{if(a)throw i}}}}function j(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=new Array(n);e<n;e++)o[e]=t[e];return o}var D=function(t){var n=t.VueHelper;this.title="Site Console",this.components=new c(t),this.tables=new u,this.start=function(e){var o=this;this.components.sort(),this.components.start(this);var r=t.store.state.user.user,i='<div class="cl-console"><site-header :title="title">\n<console-nav :courseconsole="courseconsole" :user="user"></console-nav>\n</site-header>';this.components.main.forEach((function(t){i+="<".concat(t.tag," />")})),i+="\n<router-view></router-view>\n<site-footer></site-footer></div>";var s,a=[],c=N(this.components.getRoutes());try{for(c.s();!(s=c.n()).done;){var u=s.value,f={path:t.root+"/cl/console"+u.route,component:u.component};void 0!==u.props&&(f.props=u.props),void 0!==u.name&&(f.name=u.name),a.push(f)}}catch(t){c.e(t)}finally{c.f()}this.components.pages.forEach((function(n){if(r.atLeast(n.minimumRole(r))){var e=void 0!==n.component?n.component:new l(o,t,r,n);a.push({path:t.root+"/cl/console"+n.route,component:e}),n.sections.forEach((function(n){n.options.forEach((function(n){n.available(r)&&void 0!==n.routes&&n.routes.forEach((function(n){var e={path:t.root+"/cl/console"+n.route,component:n.component};void 0!==n.props&&(e.props=n.props),void 0!==n.name&&(e.name=n.name),a.push(e)}))}))}))}})),a.push({path:"/:pathMatch(.*)",component:O});var h=t.info.header.component(),d=t.info.footer.component(),p=(0,R.p7)({history:(0,R.PO)(),routes:a}),v={"site-header":h,"site-footer":d,"console-nav":_},m=t.store,g=this.title,b=this,y=n.createApp({template:i,data:function(){return{title:g,courseconsole:b,console:b,user:r}},components:v,methods:{isAdmin:function(){return admin},setTitle:function(t){this.title=g+t,document.title=Site.info.siteName+" "+g+t}},created:function(){this.setTitle("")},mounted:function(){new t.StickyNav("div.cl-console nav")}});y.config.globalProperties.$site=t,y.config.globalProperties.$store=m,y.use(p),this.masterVue=y,p.isReady().then((function(){n.mount(y,e)}))}},I=function(t){return(0,f.dD)("data-v-aea22358"),t=t(),(0,f.Cn)(),t},M={class:"content"},U=I((function(){return(0,f._)("h2",null,"Database Tables Management",-1)})),x=I((function(){return(0,f._)("p",{class:"center red"},[(0,f._)("em",null,"Use with caution!")],-1)})),P=I((function(){return(0,f._)("p",null,"The page provides an Administrator the ability to create and destroy database tables. Only use during course startup! The create option will not drop an existing table unless the drop and create option is selected. The clean option allows for cleaning of orphaned records from tables.",-1)})),Z=I((function(){return(0,f._)("tr",null,[(0,f._)("th",null,"Tables"),(0,f._)("th",{colspan:"3"},"Operations")],-1)})),q=["onClick"],z=["onClick"],B=["onClick"],H={key:0,class:"code"};var K=e(34659);const F={data:function(){return{tables:this.$root.console.tables.tables,results:""}},mounted:function(){this.$root.setTitle(": Database Tables"),this.$root.console.tables.tables.sort((function(t,n){return t.order-n.order}))},methods:{create:function(t,n){var e=this;this.$site.api.post(t.api,{drop:n?"yes":"no"}).then((function(o){o.hasError()?e.$site.toast(e,o):n?e.$site.toast(e,t.title+" tables dropped and recreated"):e.$site.toast(e,t.title+" tables created")})).catch((function(t){e.$site.toast(e,t)}))},dropCreate:function(t){var n=this;new K.Z.MessageBox("Are you sure?","Are you sure you want to drop and recreate the "+t.title+" tables?",K.Z.MessageBox.OKCANCEL,(function(){n.create(t,!0)}))},clean:function(t){var n=this;this.$site.api.post(t.api,{clean:"yes"}).then((function(e){if(e.hasError())n.$site.toast(n,e);else{var o=e.getData("table-clean").attributes;n.results+=t.title+" Tables\n\n"+o+"\n",console.log(o)}})).catch((function(t){n.$site.toast(n,t)}))}}};var V=e(68572),X=e.n(V),Y=e(84879),W=e.n(Y),G=e(55438),J=e.n(G),Q=e(59425),tt=e.n(Q),nt=e(37930),et=e.n(nt),ot=e(76686),rt=e.n(ot),it=e(76535),st={};st.styleTagTransform=rt(),st.setAttributes=tt(),st.insert=J().bind(null,"head"),st.domAPI=W(),st.insertStyleElement=et();X()(it.Z,st);it.Z&&it.Z.locals&&it.Z.locals;const at=(0,S.Z)(F,[["render",function(t,n,e,o,r,i){return(0,f.wg)(),(0,f.iD)("div",M,[U,x,P,(0,f._)("div",null,[(0,f._)("table",null,[Z,((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(t.tables,(function(t){return(0,f.wg)(),(0,f.iD)("tr",null,[(0,f._)("td",null,(0,f.zw)(t.title),1),(0,f._)("td",null,[(0,f._)("button",{onClick:(0,f.iM)((function(n){return i.create(t,!1)}),["prevent"])},"create",8,q)]),(0,f._)("td",null,[(0,f._)("button",{onClick:(0,f.iM)((function(n){return i.dropCreate(t)}),["prevent"])},"drop-and-create",8,z)]),(0,f._)("td",null,[(0,f._)("button",{onClick:(0,f.iM)((function(n){return i.clean(t)}),["prevent"])},"clean",8,B)])])})),256))])]),t.results.length>0?((0,f.wg)(),(0,f.iD)("pre",H,(0,f.zw)(t.results),1)):(0,f.kq)("v-if",!0)])}],["__scopeId","data-v-aea22358"]]);const ct={extends:Site.UserVueBase,methods:{addNav2:function(t,n,e){var o=this.$root.console.components.addNav2Link(this,t,n,e);return this.components1.push(o),o},addNav2Link:function(t,n,e){var o=this;this.addNav2(t,n,(function(){o.$router.push(Site.root+e)}))},removeNav2:function(t){var n=this.components1.indexOf(t);n>=0&&this.components1.splice(n,1),this.$root.console.components.removeNav2(this,t)},timeRelativeUNIX:function(t,n,e){return this.$site.TimeFormatter.relativeUNIX(t,n,e)}},created:function(){this.components1=[]},beforeUnmount:function(){this.$root.console.components.removeNav2(this,this.components1)}};var ut=function(){};if(ut.create=function(t){var n=new D(t);return t.console=n,n.components.addOption({atLeast:Site.User.STAFF,page:{title:"Main",route:"",order:1}}),n.components.addOption({atLeast:Site.User.ADMIN,page:{title:"Management",route:"/management",order:10},section:{title:"Site Management",order:1},title:"Tables",order:10,route:"/management/tables",routes:[{route:"/management/tables",name:"tables",component:at}]}),t.start((function(){var t=document.querySelector("div.cl-console");null!==t&&n.start(t)})),t.ConsoleComponentBase=ct,n},Site.ConsoleComponentBase=ct,!Site.Console){var lt=ut.create(Site);Site.Console=lt}},76535:(t,n,e)=>{"use strict";e.d(n,{Z:()=>a});var o=e(3041),r=e.n(o),i=e(52281),s=e.n(i)()(r());s.push([t.id,"table td[data-v-aea22358]{padding:.25em}table button[data-v-aea22358]{display:inline-block;font-size:.85em;font-style:italic}li span[data-v-aea22358]{display:inline-block;width:6em;font-size:inherit;font-style:normal}",""]);const a=s}},t=>{t.O(0,[736,530,592],(()=>{return n=95819,t(t.s=n);var n}));t.O()}]);